<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>ALISHASHOP Manager Mobile</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              alisha: {
                orange: '#FF6B35',
                blue: '#2196F3',
              }
            }
          }
        }
      }
    </script>
    <style>
      body {
        -webkit-tap-highlight-color: transparent;
        font-family: Arial, sans-serif;
      }
      input, select, button {
        font-size: 16px;
      }
      
      @keyframes slide-up {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }
      
      @keyframes slide-down {
        from { opacity: 0; transform: translateY(-20px); }
        to { opacity: 1; transform: translateY(0); }
      }
      
      @keyframes fade-in {
        from { opacity: 0; }
        to { opacity: 1; }
      }
      
      .animate-slide-up { animation: slide-up 0.3s ease-out; }
      .animate-slide-down { animation: slide-down 0.3s ease-out; }
      .animate-fade-in { animation: fade-in 0.2s ease-out; }
      
      input[type="number"]::-webkit-inner-spin-button,
      input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }
      
      input[type="number"] {
        -moz-appearance: textfield;
      }
      
      .pb-safe {
        padding-bottom: env(safe-area-inset-bottom);
      }
    </style>
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "lucide-react": "https://esm.sh/lucide-react@0.263.1"
      }
    }
    </script>
</head>
<body class="bg-gray-50">
    <div id="root"></div>
    
    <script type="module">
      import React from 'react';
      import ReactDOM from 'react-dom/client';
      import { ShoppingCart, RefreshCw, BarChart2, Play, Smartphone, FileText, Plus, Printer, Zap, Tv, LogOut, Settings, Moon, Edit, Trash2, ArrowDownCircle, Calendar, DollarSign, ArrowLeft, AlertCircle, CheckCircle, Info, XCircle, Lock, User as UserIcon, Package, X, Save, Minus, Home, ShieldCheck, ArrowUpCircle } from 'lucide-react';

      // ============ TYPES ============
      const NotificationType = {
        SUCCESS: 'success',
        ERROR: 'error',
        WARNING: 'warning',
        INFO: 'info'
      };

      const TransactionType = {
        SALE: 'Vente Boutique',
        MONEY_TRANSFER: 'Mobile Money',
        BILL_PAYMENT: 'Paiement Facture',
        SERVICE_OFFICE: 'Bureautique',
        SERVICE_OTHER: 'Autre Service'
      };

      // ============ UTILS ============
      const formatCurrency = (amount) => amount.toLocaleString('fr-FR') + ' FCFA';
      
      const generateTransactionId = () => 'TX-' + Math.floor(Math.random() * 1000000).toString().padStart(6, '0');
      
      const formatTime = (timestamp) => new Date(timestamp).toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
      
      const formatDate = (timestamp) => new Date(timestamp).toLocaleDateString('fr-FR', { weekday: 'short', day: 'numeric', month: 'short' });
      
      const playWarningSound = () => {
        try {
          const audioContext = new (window.AudioContext || window.webkitAudioContext)();
          const oscillator = audioContext.createOscillator();
          const gainNode = audioContext.createGain();
          oscillator.type = 'sawtooth';
          oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
          oscillator.frequency.exponentialRampToValueAtTime(880, audioContext.currentTime + 0.1);
          gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.5);
          oscillator.connect(gainNode);
          gainNode.connect(audioContext.destination);
          oscillator.start();
          oscillator.stop(audioContext.currentTime + 0.5);
        } catch (e) { console.error(e); }
      };

      // ============ DATA ============
      const USERS = [
        { id: 'U1', name: 'Administrateur', pin: '1234', role: 'admin' },
        { id: 'U2', name: 'Caissier 1', pin: '0000', role: 'staff' },
      ];

      const INITIAL_PRODUCTS = [
        { id: 'P001', name: 'Ecouteurs Bluetooth', stock: 12, price: 3500, category: 'High-Tech' },
        { id: 'P002', name: 'Câble USB Type-C', stock: 25, price: 1500, category: 'High-Tech' },
        { id: 'P003', name: 'Clé USB 32GB', stock: 4, price: 4500, category: 'Stockage' },
        { id: 'P004', name: 'Rame Papier A4', stock: 3, price: 3500, category: 'Bureautique' },
        { id: 'P005', name: 'Stylo Bleu', stock: 50, price: 100, category: 'Bureautique' },
      ];

      const INITIAL_SERVICES = [
        { id: 'S1', name: 'Photocopie N&B', price: 50, category: 'office' },
        { id: 'S2', name: 'Photocopie Couleur', price: 100, category: 'office' },
        { id: 'S3', name: 'Impression', price: 100, category: 'office' },
        { id: 'S4', name: 'Plastification', price: 500, category: 'office' },
        { id: 'S5', name: 'Reliure', price: 1000, category: 'office' },
        { id: 'S6', name: 'Scanner', price: 200, category: 'office' },
        { id: 'S7', name: 'Photo Identité', price: 2000, category: 'office' },
      ];

      // ============ COMPONENTS ============
      
      // NotificationBanner Component
      const NotificationBanner = ({ notification, onClose }) => {
        React.useEffect(() => {
          if (notification) {
            const timer = setTimeout(onClose, 4000);
            return () => clearTimeout(timer);
          }
        }, [notification, onClose]);

        if (!notification) return null;

        const icons = {
          [NotificationType.SUCCESS]: React.createElement(CheckCircle, { size: 20 }),
          [NotificationType.ERROR]: React.createElement(XCircle, { size: 20 }),
          [NotificationType.WARNING]: React.createElement(AlertCircle, { size: 20 }),
          [NotificationType.INFO]: React.createElement(Info, { size: 20 })
        };

        const colors = {
          [NotificationType.SUCCESS]: 'bg-green-500 text-white',
          [NotificationType.ERROR]: 'bg-red-500 text-white',
          [NotificationType.WARNING]: 'bg-orange-500 text-white',
          [NotificationType.INFO]: 'bg-blue-500 text-white'
        };

        return React.createElement('div', { className: "fixed top-20 left-0 right-0 z-50 px-4 animate-slide-down" },
          React.createElement('div', { className: `max-w-md mx-auto ${colors[notification.type]} rounded-2xl shadow-2xl p-4 flex items-center space-x-3` },
            React.createElement('div', { className: "flex-shrink-0" }, icons[notification.type]),
            React.createElement('div', { className: "flex-1" },
              React.createElement('p', { className: "font-bold text-sm" }, notification.message),
              notification.details && React.createElement('p', { className: "text-xs opacity-90 mt-0.5" }, notification.details)
            ),
            React.createElement('button', { onClick: onClose, className: "flex-shrink-0 hover:opacity-70" },
              React.createElement(XCircle, { size: 18 })
            )
          )
        );
      };

      // ProductCard Component
      const ProductCard = ({ product }) => {
        const isLowStock = product.stock <= 4;
        
        return React.createElement('div', { className: "bg-white dark:bg-slate-800 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-slate-700 hover:shadow-md transition-shadow" },
          React.createElement('div', { className: "flex items-start justify-between" },
            React.createElement('div', { className: "flex-1" },
              React.createElement('div', { className: "flex items-center space-x-2 mb-2" },
                React.createElement('div', { className: "p-2 bg-purple-100 dark:bg-purple-900/30 text-purple-600 rounded-lg" },
                  React.createElement(Package, { size: 16 })
                ),
                React.createElement('h3', { className: "font-bold text-sm" }, product.name)
              ),
              product.category && React.createElement('span', { className: "inline-block text-[10px] font-bold uppercase tracking-wider text-gray-400 mb-2" }, product.category),
              React.createElement('div', { className: "flex items-center justify-between mt-3" },
                React.createElement('div', null,
                  React.createElement('p', { className: "text-xs text-gray-500 dark:text-gray-400" }, "Prix unitaire"),
                  React.createElement('p', { className: "font-black text-lg text-purple-600 dark:text-purple-400" }, formatCurrency(product.price))
                ),
                React.createElement('div', { className: "text-right" },
                  React.createElement('p', { className: "text-xs text-gray-500 dark:text-gray-400" }, "Stock"),
                  React.createElement('p', { className: `font-black text-lg ${isLowStock ? 'text-red-600 dark:text-red-400' : 'text-green-600 dark:text-green-400'}` }, product.stock)
                )
              )
            )
          ),
          isLowStock && React.createElement('div', { className: "mt-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800/30 rounded-lg px-3 py-2" },
            React.createElement('p', { className: "text-xs font-bold text-red-600 dark:text-red-400" }, "⚠️ Stock critique - Réapprovisionner")
          )
        );
      };

      // LoginScreen Component
      const LoginScreen = ({ users, onLogin, setNotification }) => {
        const [selectedUserId, setSelectedUserId] = React.useState(users[0]?.id || '');
        const [pin, setPin] = React.useState('');

        const handleLogin = (e) => {
          e.preventDefault();
          const user = users.find(u => u.id === selectedUserId);
          
          if (!user) {
            setNotification({ message: 'Utilisateur introuvable', type: NotificationType.ERROR, timestamp: Date.now() });
            return;
          }
          
          if (user.pin === pin) {
            onLogin(user);
            setNotification({ message: 'Connexion réussie', details: `Bienvenue ${user.name}`, type: NotificationType.SUCCESS, timestamp: Date.now() });
          } else {
            setNotification({ message: 'Code PIN incorrect', type: NotificationType.ERROR, timestamp: Date.now() });
            setPin('');
          }
        };

        const handlePinPad = (digit) => {
          if (pin.length < 4) setPin(pin + digit);
        };

        const handleDelete = () => setPin(pin.slice(0, -1));

        return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-orange-400 via-pink-500 to-purple-600 flex items-center justify-center p-4" },
          React.createElement('div', { className: "w-full max-w-md" },
            React.createElement('div', { className: "text-center mb-8" },
              React.createElement('div', { className: "inline-flex items-center justify-center w-20 h-20 rounded-3xl bg-white shadow-2xl mb-4" },
                React.createElement('span', { className: "text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-pink-600" }, "A")
              ),
              React.createElement('h1', { className: "text-3xl font-black text-white mb-2" }, "ALISHASHOP"),
              React.createElement('p', { className: "text-white/80 text-sm font-bold" }, "Manager Mobile")
            ),
            React.createElement('div', { className: "bg-white rounded-3xl shadow-2xl p-8" },
              React.createElement('form', { onSubmit: handleLogin },
                React.createElement('div', { className: "mb-6" },
                  React.createElement('label', { className: "text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 block" }, "Utilisateur"),
                  React.createElement('div', { className: "relative" },
                    React.createElement('select', {
                      value: selectedUserId,
                      onChange: (e) => setSelectedUserId(e.target.value),
                      className: "w-full p-4 pl-12 rounded-2xl bg-gray-50 border-2 border-gray-200 font-bold text-gray-800 outline-none focus:border-orange-400 transition-colors appearance-none"
                    }, users.map(user => React.createElement('option', { key: user.id, value: user.id }, user.name))),
                    React.createElement(UserIcon, { className: "absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400", size: 20 })
                  )
                ),
                React.createElement('div', { className: "mb-6" },
                  React.createElement('label', { className: "text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 block" }, "Code PIN"),
                  React.createElement('div', { className: "flex justify-center space-x-3 mb-6" },
                    [0, 1, 2, 3].map(i => React.createElement('div', {
                      key: i,
                      className: `w-14 h-14 rounded-2xl flex items-center justify-center border-2 transition-all ${pin.length > i ? 'bg-gradient-to-br from-orange-400 to-pink-500 border-orange-400' : 'bg-gray-50 border-gray-200'}`
                    }, pin.length > i && React.createElement(Lock, { className: "text-white", size: 24 })))
                  ),
                  React.createElement('div', { className: "grid grid-cols-3 gap-3" },
                    [1, 2, 3, 4, 5, 6, 7, 8, 9].map(num => React.createElement('button', {
                      key: num,
                      type: "button",
                      onClick: () => handlePinPad(num.toString()),
                      className: "h-16 rounded-2xl bg-gray-50 hover:bg-gray-100 active:scale-95 font-black text-2xl text-gray-700 transition-all"
                    }, num)),
                    React.createElement('button', {
                      type: "button",
                      onClick: handleDelete,
                      className: "h-16 rounded-2xl bg-red-50 hover:bg-red-100 active:scale-95 font-bold text-red-600 transition-all"
                    }, "←"),
                    React.createElement('button', {
                      type: "button",
                      onClick: () => handlePinPad('0'),
                      className: "h-16 rounded-2xl bg-gray-50 hover:bg-gray-100 active:scale-95 font-black text-2xl text-gray-700 transition-all"
                    }, "0"),
                    React.createElement('button', {
                      type: "submit",
                      disabled: pin.length !== 4,
                      className: `h-16 rounded-2xl font-bold transition-all ${pin.length === 4 ? 'bg-gradient-to-r from-green-500 to-emerald-600 text-white hover:scale-105 shadow-lg' : 'bg-gray-200 text-gray-400 cursor-not-allowed'}`
                    }, "OK")
                  )
                )
              )
            ),
            React.createElement('p', { className: "text-center text-white/60 text-xs mt-6" }, "© 2024 ALISHASHOP - Tous droits réservés")
          )
        );
      };

      // ProductForm Component
      const ProductForm = ({ product, onSave, onCancel, isDark }) => {
        const [formData, setFormData] = React.useState({
          id: product?.id || `P${Date.now()}`,
          name: product?.name || '',
          stock: product?.stock || 0,
          price: product?.price || 0,
          category: product?.category || 'Général'
        });

        const handleSubmit = (e) => {
          e.preventDefault();
          if (formData.name && formData.price > 0) onSave(formData);
        };

        return React.createElement('div', { className: "fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in" },
          React.createElement('div', { className: `w-full max-w-md rounded-3xl shadow-2xl p-6 ${isDark ? 'bg-slate-800' : 'bg-white'}` },
            React.createElement('div', { className: "flex justify-between items-center mb-6" },
              React.createElement('h2', { className: "text-xl font-black" }, product ? 'Modifier Produit' : 'Nouveau Produit'),
              React.createElement('button', { onClick: onCancel, className: "p-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors" },
                React.createElement(X, { size: 24 })
              )
            ),
            React.createElement('form', { onSubmit: handleSubmit, className: "space-y-4" },
              React.createElement('div', null,
                React.createElement('label', { className: "text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 block" }, "Nom du Produit"),
                React.createElement('input', {
                  type: "text",
                  value: formData.name,
                  onChange: (e) => setFormData({ ...formData, name: e.target.value }),
                  className: `w-full p-4 rounded-2xl font-medium outline-none focus:ring-4 focus:ring-purple-100 transition-all ${isDark ? 'bg-slate-700 text-white' : 'bg-gray-50 text-gray-800'}`,
                  placeholder: "Ex: Câble USB Type-C",
                  required: true
                })
              ),
              React.createElement('div', null,
                React.createElement('label', { className: "text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 block" }, "Catégorie"),
                React.createElement('input', {
                  type: "text",
                  value: formData.category,
                  onChange: (e) => setFormData({ ...formData, category: e.target.value }),
                  className: `w-full p-4 rounded-2xl font-medium outline-none focus:ring-4 focus:ring-purple-100 transition-all ${isDark ? 'bg-slate-700 text-white' : 'bg-gray-50 text-gray-800'}`,
                  placeholder: "Ex: High-Tech"
                })
              ),
              React.createElement('div', { className: "grid grid-cols-2 gap-4" },
                React.createElement('div', null,
                  React.createElement('label', { className: "text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 block" }, "Stock Initial"),
                  React.createElement('input', {
                    type: "number",
                    min: "0",
                    value: formData.stock,
                    onChange: (e) => setFormData({ ...formData, stock: parseInt(e.target.value) || 0 }),
                    className: `w-full p-4 rounded-2xl font-bold text-lg outline-none focus:ring-4 focus:ring-purple-100 transition-all ${isDark ? 'bg-slate-700 text-white' : 'bg-gray-50 text-gray-800'}`,
                    required: true
                  })
                ),
                React.createElement('div', null,
                  React.createElement('label', { className: "text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 block" }, "Prix (FCFA)"),
                  React.createElement('input', {
                    type: "number",
                    min: "0",
                    value: formData.price,
                    onChange: (e) => setFormData({ ...formData, price: parseInt(e.target.value) || 0 }),
                    className: `w-full p-4 rounded-2xl font-bold text-lg outline-none focus:ring-4 focus:ring-purple-100 transition-all ${isDark ? 'bg-slate-700 text-white' : 'bg-gray-50 text-gray-800'}`,
                    required: true
                  })
                )
              ),
              React.createElement('div', { className: "grid grid-cols-2 gap-3 pt-4" },
                React.createElement('button', {
                  type: "button",
                  onClick: onCancel,
                  className: "py-4 rounded-2xl font-bold text-gray-500 bg-gray-100 hover:bg-gray-200 dark:bg-slate-700 dark:text-gray-300 transition-colors"
                }, "Annuler"),
                React.createElement('button', {
                  type: "submit",
                  className: "py-4 rounded-2xl font-bold text-white bg-gradient-to-r from-purple-500 to-indigo-600 shadow-lg shadow-purple-500/30 hover:scale-105 transition-all"
                }, product ? 'Mettre à jour' : 'Ajouter')
              )
            )
          )
        );
      };

      // ServiceConfigModal Component
      const ServiceConfigModal = ({ services, onSave, onClose, isDark }) => {
        const [editedServices, setEditedServices] = React.useState([...services]);

        const handlePriceChange = (id, newPrice) => {
          setEditedServices(prev => prev.map(s => s.id === id ? { ...s, price: newPrice } : s));
        };

        const handleSave = () => {
          onSave(editedServices);
          onClose();
        };

        return React.createElement('div', { className: "fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in" },
          React.createElement('div', { className: `w-full max-w-md rounded-3xl shadow-2xl p-6 max-h-[80vh] overflow-y-auto ${isDark ? 'bg-slate-800' : 'bg-white'}` },
            React.createElement('div', { className: "flex justify-between items-center mb-6 sticky top-0 bg-inherit pb-4 border-b border-gray-200 dark:border-slate-700" },
              React.createElement('h2', { className: "text-xl font-black" }, "Configuration Tarifs"),
              React.createElement('button', { onClick: onClose, className: "p-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors" },
                React.createElement(X, { size: 24 })
              )
            ),
            React.createElement('div', { className: "space-y-3" },
              editedServices.map(service => React.createElement('div', {
                key: service.id,
                className: `p-4 rounded-2xl border-2 ${isDark ? 'bg-slate-700 border-slate-600' : 'bg-gray-50 border-gray-200'}`
              },
                React.createElement('div', { className: "flex items-center justify-between" },
                  React.createElement('div', { className: "flex-1" },
                    React.createElement('h3', { className: "font-bold text-sm mb-1" }, service.name),
                    React.createElement('p', { className: "text-xs text-gray-500 uppercase tracking-wider" }, service.category === 'office' ? 'Bureautique' : 'Autre')
                  ),
                  React.createElement('div', { className: "flex items-center space-x-2" },
                    React.createElement('input', {
                      type: "number",
                      min: "0",
                      value: service.price,
                      onChange: (e) => handlePriceChange(service.id, parseInt(e.target.value) || 0),
                      className: `w-24 p-2 rounded-xl text-right font-bold outline-none focus:ring-2 focus:ring-blue-400 ${isDark ? 'bg-slate-600 text-white' : 'bg-white text-gray-800'}`
                    }),
                    React.createElement('span', { className: "text-sm font-medium text-gray-500" }, "FCFA")
                  )
                )
              ))
            ),
            React.createElement('div', { className: "grid grid-cols-2 gap-3 pt-6 sticky bottom-0 bg-inherit" },
              React.createElement('button', {
                onClick: onClose,
                className: "py-4 rounded-2xl font-bold text-gray-500 bg-gray-100 hover:bg-gray-200 dark:bg-slate-700 dark:text-gray-300 transition-colors"
              }, "Annuler"),
              React.createElement('button', {
                onClick: handleSave,
                className: "py-4 rounded-2xl font-bold text-white bg-gradient-to-r from-green-500 to-emerald-600 shadow-lg shadow-green-500/30 hover:scale-105 transition-all flex items-center justify-center"
              },
                React.createElement(Save, { size: 20, className: "mr-2" }),
                "Enregistrer"
              )
            )
          )
        );
      };

      // NavButton Component
      const NavButton = ({ viewName, current, setView, icon: Icon, label, theme }) => {
        const isActive = current === viewName;
        const isDark = theme === 'dark';
        
        return React.createElement('button', {
          onClick: () => setView(viewName),
          className: `flex flex-col items-center justify-center w-1/5 py-2 transition-all duration-300 relative ${isActive ? '-translate-y-2' : ''}`
        },
          React.createElement('div', {
            className: `p-2.5 rounded-2xl transition-all duration-300 ${isActive ? 'bg-gradient-to-br from-alisha-orange to-pink-500 text-white shadow-lg shadow-pink-500/30' : isDark ? 'text-slate-500 hover:text-slate-300' : 'text-gray-400 hover:text-gray-600'}`
          }, React.createElement(Icon, { size: 22, strokeWidth: isActive ? 2.5 : 2 })),
          isActive && React.createElement('span', { className: "absolute -bottom-3 text-[9px] font-bold text-alisha-orange animate-fade-in" }, label)
        );
      };

      // Service Grid Helper
      const renderServiceGrid = (category, selected, setSelected, isDark, services) => {
        const btnClass = (active, colorType) => `
          relative overflow-hidden rounded-2xl p-3 flex flex-col items-center justify-center h-24 text-center transition-all duration-300 border-2
          ${active 
            ? colorType === 'orange' 
                ? 'border-orange-400 bg-orange-50 text-orange-700 shadow-lg scale-105' 
                : 'border-blue-400 bg-blue-50 text-blue-700 shadow-lg scale-105'
            : `border-transparent ${isDark ? 'bg-slate-700 text-slate-300 hover:bg-slate-600' : 'bg-gray-50 text-gray-600 hover:bg-gray-100'}`
          }
        `;

        if (category === 'money') {
          return ['Wave', 'Orange Money', 'Free Money', 'Wizall', 'Ecobank', 'Autre'].map(op =>
            React.createElement('button', {
              key: op,
              onClick: () => setSelected(op),
              className: btnClass(selected === op, 'blue')
            },
              React.createElement('div', {
                className: `mb-2 p-2 rounded-full ${selected === op ? 'bg-blue-200 text-blue-700' : 'bg-gray-200 dark:bg-slate-600 text-gray-500'}`
              }, React.createElement(Smartphone, { size: 18 })),
              React.createElement('span', { className: "text-[10px] font-bold leading-tight" }, op)
            )
          );
        }
        
        if (category === 'bills') {
          return ['Woyofal', 'Senelec', 'Seneau', 'Canal+', 'Rapido', 'Autre'].map(op =>
            React.createElement('button', {
              key: op,
              onClick: () => setSelected(op),
              className: btnClass(selected === op, 'orange')
            },
              React.createElement('div', {
                className: `mb-2 p-2 rounded-full ${selected === op ? 'bg-orange-200 text-orange-700' : 'bg-gray-200 dark:bg-slate-600 text-gray-500'}`
              }, React.createElement(op === 'Woyofal' ? Zap : Tv, { size: 18 })),
              React.createElement('span', { className: "text-[10px] font-bold leading-tight" }, op)
            )
          );
        }
        
        if (services) {
          return services.map(s =>
            React.createElement('button', {
              key: s.id,
              onClick: () => setSelected(s.name),
              className: btnClass(selected === s.name, 'blue')
            },
              React.createElement('div', {
                className: `mb-1 p-1.5 rounded-full ${selected === s.name ? 'bg-blue-200 text-blue-700' : 'bg-gray-200 dark:bg-slate-600 text-gray-500'}`
              }, React.createElement(Printer, { size: 16 })),
              React.createElement('span', { className: "text-[9px] font-bold leading-tight truncate w-full" }, s.name),
              React.createElement('span', { className: "text-[9px] opacity-70 mt-1 bg-white/50 px-1 rounded" }, s.price + 'F')
            )
          );
        }
        
        return null;
      };

      // ============ MAIN APP ============
      const App = () => {
        const [currentUser, setCurrentUser] = React.useState(null);
        const [theme, setTheme] = React.useState('light');
        const [products, setProducts] = React.useState(INITIAL_PRODUCTS);
        const [services, setServices] = React.useState(INITIAL_SERVICES);
        const [transactions, setTransactions] = React.useState([]);
        const [notification, setNotification] = React.useState(null);
        const [view, setView] = React.useState('home');
        const [showProductForm, setShowProductForm] = React.useState(false);
        const [editingProduct, setEditingProduct] = React.useState(null);
        const [showServiceConfig, setShowServiceConfig] = React.useState(false);
        const [confirmationData, setConfirmationData] = React.useState({
          isOpen: false,
          title: '',
          details: '',
          amount: '',
          action: () => {},
          isWarning: false
        });

        const [selectedProductId, setSelectedProductId] = React.useState('');
        const [quantityStr, setQuantityStr] = React.useState('1');
        const [serviceCategory, setServiceCategory] = React.useState('money');
        const [selectedOperator, setSelectedOperator] = React.useState('');
        const [serviceAmount, setServiceAmount] = React.useState('');
        const [serviceDetails, setServiceDetails] = React.useState('');
        const [moneyFlow, setMoneyFlow] = React.useState('IN');
        const [officeServiceQty, setOfficeServiceQty] = React.useState(1);

        const isDark = theme === 'dark';
        const selectedProduct = products.find(p => p.id === selectedProductId);
        const quantityNum = parseInt(quantityStr) || 0;
        const totalSalePrice = selectedProduct ? selectedProduct.price * quantityNum : 0;

        React.useEffect(() => {
          if (products.length > 0 && !selectedProductId) setSelectedProductId(products[0].id);
        }, [products, selectedProductId]);

        if (!currentUser) {
          return React.createElement(LoginScreen, {
            users: USERS,
            onLogin: setCurrentUser,
            setNotification: setNotification
          });
        }

        const bgMain = isDark ? 'bg-slate-900' : 'bg-gray-50';
        const bgCard = isDark ? 'bg-slate-800 border-slate-700 shadow-lg' : 'bg-white border-gray-100 shadow-xl shadow-indigo-100/40';
        const textMain = isDark ? 'text-slate-100' : 'text-slate-800';
        const textSub = isDark ? 'text-slate-400' : 'text-slate-500';
        const inputBg = isDark ? 'bg-slate-700 border-slate-600 text-white' : 'bg-slate-50 border-slate-200 text-slate-800';

        const handleQtyChange = (val) => {
          if (val === '' || /^\d+$/.test(val)) setQuantityStr(val);
        };

        const handleQtyIncrement = () => {
          setQuantityStr(prev => (parseInt(prev || '0') + 1).toString());
        };

        const handleQtyDecrement = () => {
          setQuantityStr(prev => Math.max(1, (parseInt(prev || '0') - 1)).toString());
        };

        const handleQtyBlur = () => {
          if (!quantityStr || parseInt(quantityStr) === 0) setQuantityStr('1');
        };

        const executeSale = () => {
          if (!selectedProduct) return;
          const updatedProducts = products.map(p => 
            p.id === selectedProduct.id ? { ...p, stock: p.stock - quantityNum } : p
          );
          setProducts(updatedProducts);

          const newTx = {
            id: generateTransactionId(),
            type: TransactionType.SALE,
            description: `${selectedProduct.name} x${quantityNum}`,
            amount: totalSalePrice,
            flow: 'IN',
            quantity: quantityNum,
            timestamp: Date.now(),
            relatedId: selectedProduct.id,
            performerName: currentUser.name
          };
          setTransactions(prev => [newTx, ...prev]);

          const newStock = selectedProduct.stock - quantityNum;
          let notifType = NotificationType.SUCCESS;
          
          if (newStock <= 4) {
            notifType = NotificationType.WARNING;
            playWarningSound();
          }

          setNotification({ 
            message: "Vente Validée", 
            details: `Nouveau Stock: ${newStock}`, 
            type: notifType, 
            timestamp: Date.now() 
          });
          
          setQuantityStr('1');
          setConfirmationData({ ...confirmationData, isOpen: false });
          setView('home');
        };

        const handleInitiateSale = () => {
          if (!selectedProduct) return;
          if (quantityNum <= 0) {
            setNotification({ 
              message: "Quantité Invalide", 
              type: NotificationType.ERROR, 
              timestamp: Date.now() 
            });
            return;
          }
          if (selectedProduct.stock < quantityNum) {
            setNotification({ 
              message: "Stock insuffisant", 
              details: `Max: ${selectedProduct.stock}`, 
              type: NotificationType.ERROR, 
              timestamp: Date.now() 
            });
            return;
          }

          setConfirmationData({
            isOpen: true,
            title: "Confirmer la Vente",
            details: `${selectedProduct.name} (x${quantityNum})`,
            amount: formatCurrency(totalSalePrice),
            action: executeSale
          });
        };

        const executeService = (desc, amount) => {
          let txType = TransactionType.SERVICE_OTHER;
          let flow = 'IN';

          if (serviceCategory === 'money') {
            txType = TransactionType.MONEY_TRANSFER;
            flow = moneyFlow;
          } else if (serviceCategory === 'bills') {
            txType = TransactionType.BILL_PAYMENT;
            flow = 'IN';
          } else if (serviceCategory === 'office') {
            txType = TransactionType.SERVICE_OFFICE;
            flow = 'IN';
          }

          const newTx = {
            id: generateTransactionId(),
            type: txType,
            description: desc,
            amount: amount,
            flow: flow,
            operator: selectedOperator,
            timestamp: Date.now(),
            performerName: currentUser.name
          };

          setTransactions(prev => [newTx, ...prev]);
          setNotification({ 
            message: "Opération Réussie", 
            type: NotificationType.SUCCESS, 
            timestamp: Date.now() 
          });
          
          setServiceAmount('');
          setOfficeServiceQty(1);
          setConfirmationData({ ...confirmationData, isOpen: false });
          setView('home');
        };

        const handleInitiateService = () => {
          let desc = serviceDetails || "Service";
          let amount = parseInt(serviceAmount) || 0;
          let flowLabel = "";

          if (serviceCategory === 'money') {
            if (!selectedOperator) return;
            flowLabel = moneyFlow === 'IN' ? 'DÉPÔT (Entrée Caisse)' : 'RETRAIT (Sortie Caisse)';
            desc = `${selectedOperator}`;
          } else if (serviceCategory === 'bills') {
            if (!selectedOperator) return;
            flowLabel = "Paiement Facture";
            desc = `Paiement ${selectedOperator}`;
          } else if (serviceCategory === 'office') {
            const serviceDef = services.find(s => s.name === selectedOperator);
            if (serviceDef) {
              amount = serviceDef.price * officeServiceQty;
              desc = `${selectedOperator} x${officeServiceQty}`;
              flowLabel = "Prestation Service";
            } else return;
          }

          if (!amount || amount <= 0) {
            setNotification({ 
              message: "Montant invalide", 
              type: NotificationType.ERROR, 
              timestamp: Date.now() 
            });
            return;
          }

          setConfirmationData({
            isOpen: true,
            title: "Confirmer Transaction",
            details: `${flowLabel} - ${desc}`,
            amount: formatCurrency(amount),
            action: () => executeService(desc, amount),
            isWarning: moneyFlow === 'OUT'
          });
        };

        const checkLowStock = () => {
          const lowStockItems = products.filter(p => p.stock <= 4);
          if (lowStockItems.length > 0) {
            setNotification({ 
              message: "Alerte Stock", 
              details: `${lowStockItems.length} produits critiques`, 
              type: NotificationType.WARNING, 
              timestamp: Date.now() 
            });
            playWarningSound();
          } else {
            setNotification({ 
              message: "Stock Sain", 
              type: NotificationType.SUCCESS, 
              timestamp: Date.now() 
            });
          }
        };

        const handleSaveProduct = (p) => {
          setProducts(prev => editingProduct ? prev.map(pr => pr.id === p.id ? p : pr) : [p, ...prev]);
          setNotification({ 
            message: "Stock Mis à jour", 
            type: NotificationType.SUCCESS, 
            timestamp: Date.now() 
          });
          setShowProductForm(false);
        };

        const dashboardCards = [
          { id: 'sale', title: 'Boutique', icon: ShoppingCart, color: 'from-orange-400 to-pink-500', desc: 'Encaisser une vente' },
          { id: 'services', title: 'Services', icon: Smartphone, color: 'from-blue-400 to-indigo-600', desc: 'Transfert & Factures' },
          { id: 'stock', title: 'Stock', icon: BarChart2, color: 'from-purple-400 to-violet-600', desc: 'Inventaire produits' },
          { id: 'report', title: 'Rapports', icon: FileText, color: 'from-emerald-400 to-teal-600', desc: 'Historique ventes' },
        ];

        const last8Days = Array.from({length: 8}, (_, i) => {
          const d = new Date();
          d.setDate(d.getDate() - i);
          d.setHours(0,0,0,0);
          return d.getTime();
        });

        return React.createElement('div', { 
          className: `min-h-screen flex flex-col font-sans pb-24 transition-colors duration-300 ${bgMain} ${textMain}` 
        },
          // Header
          React.createElement('header', { 
            className: "bg-white dark:bg-slate-800 sticky top-0 z-30 border-b border-gray-200 dark:border-slate-700 backdrop-blur-md bg-opacity-80" 
          },
            React.createElement('div', { className: "max-w-md mx-auto px-4 py-3 flex justify-between items-center" },
              React.createElement('div', { className: "flex items-center" },
                view !== 'home' && React.createElement('button', {
                  onClick: () => setView('home'),
                  className: "mr-3 p-2 rounded-full bg-gray-100 dark:bg-slate-700 hover:bg-gray-200 transition-colors"
                }, React.createElement(ArrowLeft, { size: 20, className: "text-alisha-orange" })),
                React.createElement('div', { className: "flex items-center space-x-2" },
                  React.createElement('div', { 
                    className: "w-10 h-10 rounded-lg bg-gradient-to-br from-alisha-orange to-pink-500 flex items-center justify-center shadow-lg shadow-orange-500/30 text-white font-black italic text-lg" 
                  }, "A"),
                  React.createElement('div', null,
                    React.createElement('h1', { 
                      className: "font-black text-lg tracking-tight leading-none text-transparent bg-clip-text bg-gradient-to-r from-alisha-orange to-pink-600" 
                    }, "ALISHASHOP"),
                    React.createElement('p', { 
                      className: "text-[10px] font-bold uppercase tracking-wider text-gray-400" 
                    }, "Manager")
                  )
                )
              ),
              React.createElement('div', { className: "flex flex-col items-end" },
                React.createElement('span', { 
                  className: "text-[10px] bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-bold uppercase" 
                }, currentUser.role === 'admin' ? 'Gérant' : 'Caissier'),
                React.createElement('span', { 
                  className: "text-xs font-medium text-gray-500 dark:text-gray-400" 
                }, currentUser.name)
              )
            )
          ),

          React.createElement(NotificationBanner, { 
            notification: notification, 
            onClose: () => setNotification(null) 
          }),

          // Main Content
          React.createElement('main', { className: "flex-grow p-4 max-w-md mx-auto w-full space-y-6" },
            
            // Confirmation Modal
            confirmationData.isOpen && React.createElement('div', { 
              className: "fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in" 
            },
              React.createElement('div', { 
                className: `w-full max-w-xs rounded-3xl shadow-2xl p-6 transform transition-all scale-100 ${isDark ? 'bg-slate-800' : 'bg-white'}` 
              },
                React.createElement('div', { className: "flex justify-center mb-4" },
                  React.createElement('div', { 
                    className: `p-4 rounded-full ${confirmationData.isWarning ? 'bg-red-100 text-red-500' : 'bg-green-100 text-green-600'}` 
                  }, React.createElement(ShieldCheck, { size: 48 }))
                ),
                React.createElement('h3', { className: "text-center text-xl font-black mb-1" }, confirmationData.title),
                React.createElement('p', { className: `text-center text-sm mb-6 ${textSub}` }, "Voulez-vous confirmer cette opération ?"),
                React.createElement('div', { 
                  className: `p-4 rounded-2xl mb-6 text-center ${isDark ? 'bg-slate-700' : 'bg-gray-50'}` 
                },
                  React.createElement('div', { className: "text-lg font-medium leading-tight mb-1" }, confirmationData.details),
                  React.createElement('div', { 
                    className: `text-2xl font-black ${confirmationData.isWarning ? 'text-red-500' : 'text-alisha-blue'}` 
                  }, confirmationData.amount)
                ),
                React.createElement('div', { className: "grid grid-cols-2 gap-3" },
                  React.createElement('button', {
                    onClick: () => setConfirmationData({...confirmationData, isOpen: false}),
                    className: "py-3 rounded-xl font-bold text-gray-500 bg-gray-100 hover:bg-gray-200 dark:bg-slate-700 dark:text-gray-300"
                  }, "Annuler"),
                  React.createElement('button', {
                    onClick: confirmationData.action,
                    className: `py-3 rounded-xl font-bold text-white shadow-lg ${confirmationData.isWarning ? 'bg-gradient-to-r from-red-500 to-orange-500 shadow-red-500/30' : 'bg-gradient-to-r from-green-500 to-emerald-600 shadow-green-500/30'}`
                  }, "Confirmer")
                )
              )
            ),

            // HOME VIEW
            view === 'home' && React.createElement('div', { className: "animate-slide-up space-y-6" },
              React.createElement('div', { className: "text-center py-2" },
                React.createElement('h2', { className: "text-2xl font-black" }, `Bienvenue, ${currentUser.name.split(' ')[0]}`),
                React.createElement('p', { className: `${textSub} text-sm` }, "Sélectionnez un module pour commencer")
              ),
              React.createElement('div', { className: "grid grid-cols-2 gap-4" },
                dashboardCards.map(card => React.createElement('button', {
                  key: card.id,
                  onClick: () => setView(card.id),
                  className: `relative overflow-hidden rounded-3xl p-5 h-40 flex flex-col justify-between text-left shadow-xl transition-transform hover:scale-[1.02] active:scale-95 ${isDark ? 'bg-slate-800' : 'bg-white'}`
                },
                  React.createElement('div', { 
                    className: `absolute top-0 right-0 p-20 rounded-full blur-2xl opacity-20 bg-gradient-to-br ${card.color} -mr-10 -mt-10` 
                  }),
                  React.createElement('div', { 
                    className: `w-12 h-12 rounded-2xl bg-gradient-to-br ${card.color} flex items-center justify-center text-white shadow-lg mb-3` 
                  }, React.createElement(card.icon, { size: 24 })),
                  React.createElement('div', null,
                    React.createElement('h3', { className: "font-black text-lg leading-tight" }, card.title),
                    React.createElement('p', { className: `text-[10px] font-bold uppercase tracking-wider mt-1 ${textSub}` }, card.desc)
                  )
                ))
              ),
              React.createElement('button', {
                onClick: () => setView('settings'),
                className: `w-full p-4 rounded-2xl flex items-center justify-between shadow-sm ${bgCard}`
              },
                React.createElement('div', { className: "flex items-center" },
                  React.createElement('div', { className: "p-2 bg-gray-100 dark:bg-slate-700 rounded-xl mr-3 text-gray-500" },
                    React.createElement(Settings, { size: 20 })
                  ),
                  React.createElement('div', { className: "text-left" },
                    React.createElement('h3', { className: "font-bold" }, "Paramètres"),
                    React.createElement('p', { className: "text-xs text-gray-500" }, "Compte, Thème, Tarifs")
                  )
                ),
                React.createElement(ArrowLeft, { size: 16, className: "rotate-180 text-gray-400" })
              )
            ),

            // SALE VIEW - Suite
            view === 'sale' && React.createElement('div', { className: "animate-slide-up space-y-4" },
              React.createElement('div', { className: `${bgCard} rounded-3xl p-6 border-0` },
                React.createElement('div', { className: "flex items-center mb-6 space-x-3" },
                  React.createElement('div', { 
                    className: "p-3 rounded-xl bg-gradient-to-br from-orange-400 to-pink-500 text-white shadow-lg shadow-orange-500/30" 
                  }, React.createElement(ShoppingCart, { size: 24 })),
                  React.createElement('div', null,
                    React.createElement('h2', { className: "font-black text-xl" }, "Vente Boutique"),
                    React.createElement('p', { className: "text-xs text-gray-400" }, "Sélectionnez un article à encaisser")
                  )
                ),
                React.createElement('div', { className: "space-y-5" },
                  React.createElement('div', { className: "relative" },
                    React.createElement('label', { 
                      className: `text-[10px] font-bold uppercase tracking-wider mb-1.5 block ml-1 ${textSub}` 
                    }, "Produit"),
                    React.createElement('div', { className: "relative" },
                      React.createElement('select', {
                        value: selectedProductId,
                        onChange: (e) => setSelectedProductId(e.target.value),
                        className: `appearance-none block w-full py-4 pl-4 pr-10 rounded-2xl font-bold text-lg outline-none focus:ring-4 focus:ring-orange-100 dark:focus:ring-orange-900/30 transition-all shadow-sm ${inputBg}`
                      }, products.map(p => React.createElement('option', { key: p.id, value: p.id }, p.name))),
                      React.createElement('div', { 
                        className: "absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none text-gray-500" 
                      }, React.createElement(ArrowDownCircle, { size: 20 }))
                    ),
                    React.createElement('div', { className: "flex justify-between mt-2 px-2" },
                      React.createElement('span', { className: `text-xs font-medium ${textSub}` }, 
                        formatCurrency(selectedProduct?.price || 0) + ' / unité'
                      ),
                      React.createElement('span', { 
                        className: `text-xs font-bold px-2 py-0.5 rounded-md ${selectedProduct && selectedProduct.stock <= 4 ? "text-red-600 bg-red-100" : "text-green-600 bg-green-100"}` 
                      }, `Stock: ${selectedProduct?.stock}`)
                    )
                  ),
                  React.createElement('div', { className: "flex gap-4" },
                    React.createElement('div', { className: "w-1/2" },
                      React.createElement('label', { 
                        className: `text-[10px] font-bold uppercase tracking-wider mb-1.5 block ml-1 ${textSub}` 
                      }, "Quantité"),
                      React.createElement('div', { className: `flex items-center rounded-2xl shadow-sm overflow-hidden ${inputBg}` },
                        React.createElement('button', {
                          onClick: handleQtyDecrement,
                          className: "p-4 hover:bg-gray-200 dark:hover:bg-slate-600 text-gray-500 transition-colors"
                        }, React.createElement(Minus, { size: 20 })),
                        React.createElement('input', {
                          type: "number",
                          min: "1",
                          value: quantityStr,
                          onChange: (e) => handleQtyChange(e.target.value),
                          onBlur: handleQtyBlur,
                          className: "w-full py-4 text-center text-2xl font-black outline-none bg-transparent"
                        }),
                        React.createElement('button', {
                          onClick: handleQtyIncrement,
                          className: "p-4 hover:bg-gray-200 dark:hover:bg-slate-600 text-gray-500 transition-colors"
                        }, React.createElement(Plus, { size: 20 }))
                      )
                    ),
                    React.createElement('div', { className: "w-1/2" },
                      React.createElement('label', { 
                        className: `text-[10px] font-bold uppercase tracking-wider mb-1.5 block ml-1 ${textSub}` 
                      }, "Total"),
                      React.createElement('div', { 
                        className: "w-full py-4 px-5 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-slate-700 dark:to-slate-800 rounded-2xl text-right text-2xl font-black text-alisha-orange border border-gray-200 dark:border-slate-600 flex items-center justify-end h-[72px]" 
                      }, formatCurrency(totalSalePrice))
                    )
                  ),
                  React.createElement('button', {
                    onClick: handleInitiateSale,
                    className: "w-full py-5 bg-gradient-to-r from-alisha-orange to-pink-600 text-white rounded-2xl font-black text-lg shadow-xl shadow-orange-500/30 hover:scale-[1.02] active:scale-95 transition-all flex justify-center items-center group"
                  },
                    React.createElement('span', { 
                      className: "mr-2 bg-white/20 p-1 rounded-full group-hover:rotate-12 transition-transform" 
                    }, React.createElement(Play, { size: 16, fill: "currentColor" })),
                    "ENCAISSER"
                  )
                )
              )
            ),

            // SERVICES VIEW
            view === 'services' && React.createElement('div', { className: "animate-slide-up space-y-4" },
              React.createElement('div', { 
                className: `p-1.5 rounded-2xl shadow-inner border flex gap-1 ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-gray-100 border-gray-200'}` 
              },
                [
                  { id: 'money', label: 'Finance', icon: Smartphone },
                  { id: 'bills', label: 'Factures', icon: Zap },
                  { id: 'office', label: 'Bureau', icon: Printer }
                ].map((cat) => React.createElement('button', {
                  key: cat.id,
                  onClick: () => { 
                    setServiceCategory(cat.id); 
                    setSelectedOperator(''); 
                    setServiceAmount(''); 
                    setOfficeServiceQty(1); 
                  },
                  className: `flex-1 py-3 rounded-xl text-xs font-bold flex flex-col items-center justify-center transition-all duration-300 ${serviceCategory === cat.id ? 'bg-white dark:bg-slate-700 text-alisha-blue shadow-md transform scale-100' : 'text-gray-400 hover:bg-gray-200/50'}`
                },
                  React.createElement(cat.icon, { 
                    size: 18, 
                    className: `mb-1 ${serviceCategory === cat.id ? 'text-alisha-blue' : 'text-gray-400'}` 
                  }),
                  cat.label
                ))
              ),
              React.createElement('div', { className: `${bgCard} rounded-3xl shadow-xl p-6 border-0` },
                React.createElement('h3', { 
                  className: `text-sm font-bold uppercase tracking-wider mb-4 flex items-center ${textSub}` 
                },
                  React.createElement('span', { className: "w-2 h-2 rounded-full bg-alisha-blue mr-2" }),
                  serviceCategory === 'money' ? 'Choisir Opérateur' : serviceCategory === 'bills' ? 'Choisir Service' : 'Prestation'
                ),
                React.createElement('div', { className: "grid grid-cols-3 gap-3 mb-6" },
                  renderServiceGrid(serviceCategory, selectedOperator, setSelectedOperator, isDark, services)
                ),
                React.createElement('div', { 
                  className: `pt-6 border-t ${isDark ? 'border-slate-700' : 'border-gray-100'}` 
                },
                  serviceCategory === 'money' && selectedOperator && React.createElement('div', { className: "flex gap-3 mb-5" },
                    React.createElement('button', {
                      onClick: () => setMoneyFlow('IN'),
                      className: `flex-1 py-4 rounded-2xl font-bold flex flex-col items-center justify-center transition-all border-2 ${moneyFlow === 'IN' ? 'bg-green-50 border-green-500 text-green-700 shadow-lg shadow-green-500/10' : 'bg-gray-50 border-transparent text-gray-400'}`
                    },
                      React.createElement(ArrowDownCircle, { size: 24, className: "mb-1" }),
                      "DÉPÔT"
                    ),
                    React.createElement('button', {
                      onClick: () => setMoneyFlow('OUT'),
                      className: `flex-1 py-4 rounded-2xl font-bold flex flex-col items-center justify-center transition-all border-2 ${moneyFlow === 'OUT' ? 'bg-red-50 border-red-500 text-red-700 shadow-lg shadow-red-500/10' : 'bg-gray-50 border-transparent text-gray-400'}`
                    },
                      React.createElement(ArrowUpCircle, { size: 24, className: "mb-1" }),
                      "RETRAIT"
                    )
                  ),
                  serviceCategory === 'office' && selectedOperator ? React.createElement('div', { 
                    className: "bg-blue-50 dark:bg-slate-700/50 p-4 rounded-2xl flex items-center justify-between mb-5 border border-blue-100 dark:border-slate-600" 
                  },
                    React.createElement('div', null,
                      React.createElement('div', { className: "text-xs font-bold text-gray-500 uppercase mb-1" }, "Quantité"),
                      React.createElement('input', {
                        type: "number",
                        min: "1",
                        value: officeServiceQty,
                        onChange: (e) => setOfficeServiceQty(parseInt(e.target.value) || 1),
                        className: "w-20 bg-transparent text-3xl font-black text-alisha-blue outline-none border-b-2 border-blue-300 focus:border-blue-600"
                      })
                    ),
                    React.createElement('div', { className: "text-right" },
                      React.createElement('div', { className: "text-xs font-bold text-gray-500 uppercase mb-1" }, "Total"),
                      React.createElement('div', { className: "text-2xl font-black text-alisha-blue" },
                        formatCurrency((services.find(s => s.name === selectedOperator)?.price || 0) * officeServiceQty)
                      )
                    )
                  ) : React.createElement('div', { className: "mb-5" },
                    React.createElement('label', { 
                      className: `text-[10px] font-bold uppercase tracking-wider mb-1.5 block ml-1 ${textSub}` 
                    }, "Montant Transaction"),
                    React.createElement('input', {
                      type: "number",
                      placeholder: "0",
                      value: serviceAmount,
                      onChange: (e) => setServiceAmount(e.target.value),
                      className: `block w-full py-4 px-4 rounded-2xl text-center text-2xl font-black outline-none focus:ring-4 focus:ring-blue-100 transition-all shadow-sm ${inputBg}`
                    })
                  ),
                  React.createElement('button', {
                    onClick: handleInitiateService,
                    disabled: !selectedOperator || (serviceCategory !== 'office' && !serviceAmount),
                    className: `w-full py-4 rounded-2xl font-bold text-lg shadow-xl transition-all ${!selectedOperator || (serviceCategory !== 'office' && !serviceAmount) ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-gradient-to-r from-alisha-blue to-indigo-600 text-white shadow-blue-500/30 hover:scale-[1.02] active:scale-95'}`
                  }, "VALIDER")
                )
              )
            ),

            // STOCK VIEW
            view === 'stock' && React.createElement('div', { className: "animate-slide-up space-y-4" },
              React.createElement('div', { className: `flex justify-between items-center p-4 rounded-2xl ${bgCard}` },
                React.createElement('div', { className: "flex items-center" },
                  React.createElement('div', { 
                    className: "p-2.5 rounded-xl bg-gradient-to-br from-purple-500 to-indigo-600 text-white shadow-lg shadow-indigo-500/30 mr-3" 
                  }, React.createElement(BarChart2, { size: 20 })),
                  React.createElement('h2', { className: "text-lg font-bold" }, "Inventaire")
                ),
                React.createElement('div', { className: "flex gap-2" },
                  currentUser.role === 'admin' && React.createElement('button', {
                    onClick: () => { setEditingProduct(null); setShowProductForm(true); },
                    className: "p-3 rounded-xl bg-indigo-50 text-indigo-600 hover:bg-indigo-100 transition-colors"
                  }, React.createElement(Plus, { size: 20 })),
                  React.createElement('button', {
                    onClick: checkLowStock,
                    className: "p-3 rounded-xl bg-orange-50 text-alisha-orange hover:bg-orange-100 transition-colors"
                  }, React.createElement(RefreshCw, { size: 20 }))
                )
              ),
              React.createElement('div', { className: "grid gap-3" },
                products.map(product => React.createElement('div', { key: product.id, className: "group relative" },
                  React.createElement(ProductCard, { product: product }),
                  currentUser.role === 'admin' && React.createElement('div', { 
                    className: "absolute top-3 right-3 flex space-x-2 opacity-0 group-hover:opacity-100 transition-opacity" 
                  },
                    React.createElement('button', {
                      onClick: () => { setEditingProduct(product); setShowProductForm(true); },
                      className: "p-2 bg-white shadow text-blue-600 rounded-full"
                    }, React.createElement(Edit, { size: 14 })),
                    React.createElement('button', {
                      onClick: () => {
                        if(window.confirm('Supprimer ?')) setProducts(prev => prev.filter(p => p.id !== product.id));
                      },
                      className: "p-2 bg-white shadow text-red-600 rounded-full"
                    }, React.createElement(Trash2, { size: 14 }))
                  )
                ))
              )
            ),

            // REPORT VIEW
            view === 'report' && React.createElement('div', { className: "animate-slide-up space-y-5" },
              React.createElement('div', { className: `${bgCard} rounded-3xl shadow-xl border-0 overflow-hidden` },
                React.createElement('div', { 
                  className: "p-5 bg-gradient-to-r from-gray-50 to-white dark:from-slate-800 dark:to-slate-700 border-b dark:border-slate-600" 
                },
                  React.createElement('h2', { className: "font-black text-lg flex items-center" },
                    React.createElement('div', { className: "p-2 rounded-lg bg-blue-100 text-blue-600 mr-3" },
                      React.createElement(Calendar, { size: 18 })
                    ),
                    "Rapport 8 Jours"
                  )
                ),
                React.createElement('div', { className: "divide-y dark:divide-slate-700" },
                  last8Days.map(dateTs => {
                    const dayTxs = transactions.filter(t => new Date(t.timestamp).setHours(0,0,0,0) === dateTs);
                    const hasActivity = dayTxs.length > 0;
                    const commercialTxs = dayTxs.filter(t => t.type === TransactionType.SALE || t.type === TransactionType.SERVICE_OFFICE);
                    const revenue = commercialTxs.reduce((acc, t) => acc + t.amount, 0);
                    const financialTxs = dayTxs.filter(t => t.type === TransactionType.MONEY_TRANSFER || t.type === TransactionType.BILL_PAYMENT);
                    const flowIn = financialTxs.filter(t => t.flow === 'IN').reduce((acc, t) => acc + t.amount, 0);
                    const flowOut = financialTxs.filter(t => t.flow === 'OUT').reduce((acc, t) => acc + t.amount, 0);

                    return React.createElement('div', {
                      key: dateTs,
                      className: `p-4 ${hasActivity ? '' : 'opacity-40 bg-gray-50 dark:bg-slate-800/50'}`
                    },
                      React.createElement('div', { className: "flex justify-between items-baseline mb-2" },
                        React.createElement('span', { className: "font-bold text-sm uppercase text-gray-500" }, formatDate(dateTs)),
                        !hasActivity && React.createElement('span', { className: "text-xs" }, "-")
                      ),
                      hasActivity && React.createElement('div', { className: "grid grid-cols-2 gap-4" },
                        React.createElement('div', { 
                          className: "bg-green-50 dark:bg-green-900/20 p-2 rounded-lg border border-green-100 dark:border-green-800/30" 
                        },
                          React.createElement('div', { 
                            className: "text-[10px] font-bold text-green-600 uppercase tracking-wide" 
                          }, "Revenu Boutique"),
                          React.createElement('div', { 
                            className: "font-black text-green-700 dark:text-green-400 text-lg" 
                          }, formatCurrency(revenue))
                        ),
                        React.createElement('div', { 
                          className: "bg-blue-50 dark:bg-blue-900/20 p-2 rounded-lg border border-blue-100 dark:border-blue-800/30" 
                        },
                          React.createElement('div', { 
                            className: "text-[10px] font-bold text-blue-600 uppercase tracking-wide" 
                          }, "Flux Mobile Money"),
                          React.createElement('div', { className: "flex flex-col" },
                            React.createElement('span', { 
                              className: "text-xs font-bold text-gray-600 dark:text-gray-300" 
                            }, `In: ${formatCurrency(flowIn)}`),
                            React.createElement('span', { 
                              className: "text-xs font-bold text-gray-600 dark:text-gray-300" 
                            }, `Out: ${formatCurrency(flowOut)}`)
                          )
                        )
                      )
                    );
                  })
                )
              )
            ),

            // SETTINGS VIEW
            view === 'settings' && React.createElement('div', { className: "animate-slide-up space-y-4" },
              React.createElement('div', { className: `${bgCard} rounded-3xl p-6 border-0 space-y-6` },
                React.createElement('div', { 
                  className: "flex items-center space-x-4 pb-4 border-b border-gray-100 dark:border-slate-700" 
                },
                  React.createElement('div', { 
                    className: "w-12 h-12 rounded-full bg-gray-200 dark:bg-slate-700 flex items-center justify-center font-bold text-xl text-gray-500" 
                  }, currentUser.name.charAt(0)),
                  React.createElement('div', null,
                    React.createElement('h2', { className: "font-bold text-lg" }, currentUser.name),
                    React.createElement('p', { className: "text-xs text-gray-500 capitalize" }, currentUser.role)
                  )
                ),
                React.createElement('div', { className: "space-y-2" },
                  React.createElement('button', {
                    onClick: () => setTheme(t => t === 'light' ? 'dark' : 'light'),
                    className: "w-full flex items-center justify-between p-4 rounded-2xl bg-gray-50 dark:bg-slate-700 hover:bg-gray-100 transition-colors"
                  },
                    React.createElement('div', { className: "flex items-center" },
                      React.createElement('span', { className: "p-2 bg-purple-100 text-purple-600 rounded-lg mr-3" },
                        React.createElement(Moon, { size: 18 })
                      ),
                      React.createElement('span', { className: "font-bold text-sm" }, "Mode Sombre")
                    ),
                    React.createElement('div', { 
                      className: `w-10 h-6 rounded-full p-1 transition-colors ${isDark ? 'bg-purple-500' : 'bg-gray-300'}` 
                    },
                      React.createElement('div', { 
                        className: `w-4 h-4 bg-white rounded-full transform transition-transform ${isDark ? 'translate-x-4' : ''}` 
                      })
                    )
                  ),
                  currentUser.role === 'admin' && React.createElement('button', {
                    onClick: () => setShowServiceConfig(true),
                    className: "w-full flex items-center justify-between p-4 rounded-2xl bg-gray-50 dark:bg-slate-700 hover:bg-gray-100 transition-colors"
                  },
                    React.createElement('div', { className: "flex items-center" },
                      React.createElement('span', { className: "p-2 bg-green-100 text-green-600 rounded-lg mr-3" },
                        React.createElement(DollarSign, { size: 18 })
                      ),
                      React.createElement('span', { className: "font-bold text-sm" }, "Prix Services")
                    ),
                    React.createElement(ArrowLeft, { size: 16, className: "rotate-180 text-gray-400" })
                  )
                ),
                React.createElement('button', {
                  onClick: () => { setCurrentUser(null); setView('home'); },
                  className: "w-full py-4 mt-4 rounded-2xl font-bold text-red-500 bg-red-50 hover:bg-red-100 transition-colors flex items-center justify-center"
                },
                  React.createElement(LogOut, { size: 20, className: "mr-2" }),
                  "Se déconnecter"
                )
              )
            )
          ),

          // Navigation Bar
          React.createElement('nav', { 
            className: `fixed bottom-0 w-full flex justify-around items-center pb-safe pt-2 px-2 z-40 max-w-md left-0 right-0 mx-auto backdrop-blur-md bg-opacity-90 border-t ${isDark ? 'bg-slate-900 border-slate-800' : 'bg-white border-gray-200'}` 
          },
            React.createElement(NavButton, { viewName: 'home', current: view, setView: setView, icon: Home, label: "Accueil", theme: theme }),
            React.createElement(NavButton, { viewName: 'sale', current: view, setView: setView, icon: ShoppingCart, label: "Vente", theme: theme }),
            React.createElement(NavButton, { viewName: 'services', current: view, setView: setView, icon: Smartphone, label: "Services", theme: theme }),
            React.createElement(NavButton, { viewName: 'stock', current: view, setView: setView, icon: BarChart2, label: "Stock", theme: theme }),
            React.createElement(NavButton, { viewName: 'report', current: view, setView: setView, icon: FileText, label: "Rapport", theme: theme })
          ),

          // Modals
          showProductForm && React.createElement(ProductForm, {
            product: editingProduct,
            onSave: handleSaveProduct,
            onCancel: () => setShowProductForm(false),
            isDark: isDark
          }),
          showServiceConfig && React.createElement(ServiceConfigModal, {
            services: services,
            onSave: setServices,
            onClose: () => setShowServiceConfig(false),
            isDark: isDark
          })
        );
      };

      // ============ RENDER APP ============
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(React.createElement(React.StrictMode, null, React.createElement(App)));
    </script>
</body>
</html>